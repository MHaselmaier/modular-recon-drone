<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.8">
<meta name="author" content="Matthias Haselmaier, B.Sc. und Andreas M. Brunnet, B.Sc.">
<title>Modular Recon Drone: Dokumentation</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Uncomment @import statement below to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock pre.nowrap,.literalblock pre.nowrap pre,.listingblock pre.nowrap,.listingblock pre.nowrap pre{white-space:pre;word-wrap:normal}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #dddddf}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt,.quoteblock .quoteblock{margin:0 0 1.25em;padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
<h1>Modular Recon Drone: Dokumentation</h1>
<div class="details">
<span id="author" class="author">Matthias Haselmaier, B.Sc. und Andreas M. Brunnet, B.Sc.</span><br>
</div>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_vorwort">Vorwort</a></li>
<li><a href="#_aufbau_der_drohne">Aufbau der Drohne</a>
<ul class="sectlevel2">
<li><a href="#_main_control_unit">Main Control Unit</a></li>
<li><a href="#sec:attiny">Motor Controller</a></li>
<li><a href="#sec:camera_module">Kameramodul</a></li>
<li><a href="#sec:oled_display">Bildschirm</a></li>
<li><a href="#_stromversorgung">Stromversorgung</a></li>
<li><a href="#_schaltplan_und_pcb">Schaltplan und PCB</a></li>
</ul>
</li>
<li><a href="#_entwicklung_einer_steuerung">Entwicklung einer Steuerung</a>
<ul class="sectlevel2">
<li><a href="#_referenzimplementierung_für_android">Referenzimplementierung für Android</a></li>
</ul>
</li>
<li><a href="#_ausblick">Ausblick</a>
<ul class="sectlevel2">
<li><a href="#_gehäuse">Gehäuse</a></li>
<li><a href="#_verpolschutz">Verpolschutz</a></li>
<li><a href="#_raspberry_pi_zero_w">Raspberry PI zero W</a></li>
<li><a href="#_alternative_stromversorgung">Alternative Stromversorgung</a></li>
<li><a href="#sec:vision_external_ram">Externer SPI RAM</a></li>
<li><a href="#_drehzahlkorrektur_der_motordrehzahl">Drehzahlkorrektur der Motordrehzahl</a></li>
</ul>
</li>
<li><a href="#_glossar">Glossar</a></li>
<li><a href="#_quellen">Quellen</a></li>
<li><a href="#_anhang">Anhang</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_vorwort">Vorwort</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Im Rahmen der Master-Projektarbeit im Wintersemester 2018/19 wurde eine Modular-Recon-Drone
(modulare Aufklärungsdrohne) entwickelt. Auf Abbildung <a href="#fig:drohne">1</a> ist der finale Aufbau
gezeigt. Bei der Architektur der Hard- und Software wurde auf einen modularen Aufbau geachtet,
um die einzelnen Komponenten leicht gegen Alternativen austauschen zu können. So wurde zum Beispiel
das Ansteuern der Motoren in ein eigenes Modul ausgelagert, das über ein TWI-Interface angesprochen
werden kann. Die Drohne bietet eine simple Schnittstelle über die sie gesteuert werden kann.
Auch hier kann das Steuersystem leicht ausgetauscht oder angepasst werden. Im Rahmen dieses Projekts
wurden zwei Steuersysteme entwickelt, welche als Basis für die Entwicklung weiterer Eingabemethoden
genutzt werden können. Um die Drohne auch aus der Ferne zu steuern, verfügt sie über ein Kameramodul.</p>
</div>
<div id="fig:drohne" class="imageblock text-center">
<div class="content">
<img src="imgs/drohne.png" alt="drohne" width="500">
</div>
<div class="title">Abbildung 1. Modular-Recon-Drone</div>
</div>
<div class="paragraph">
<p>Im Folgenden werden die einzelnen Komponenten der Drohne und ihr Aufbau dokumentiert.
Anschließend werden die Steuersysteme vorgestellt.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_aufbau_der_drohne">Aufbau der Drohne</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In diesem Abschnitt werden die einzelnen Komponente der Drohne beschrieben.
Zuerst wird auf die Hauptkontrolleinheit eingegangen. Anschließend wird die
Motorsteuerung beschrieben, gefolgt vom Kameramodul und dem Bildschirm.
Abschließend wird auf die Stromversorgung und das erstellte PCB eingegangen.</p>
</div>
<div class="sect2">
<h3 id="_main_control_unit">Main Control Unit</h3>
<div class="paragraph">
<p>Die MCU ist die Hauptkontrolleinheit. Ihre Hauptaufgaben sind:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Hosten eines Access Points</p>
</li>
<li>
<p>Hosten eines UDP-Sockets</p>
</li>
<li>
<p>Hosten eines TCP-Servers</p>
</li>
<li>
<p>Hosten des TWI Master</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Grundlage der MCU bildet ein <em>Espressif ESP32</em> (DevKit v.1, siehe Abbildung <a href="#fig:esp32_devkitv1">2</a>).</p>
</div>
<div id="fig:esp32_devkitv1" class="imageblock text-center">
<div class="content">
<img src="imgs/esp32_devkitv1.png" alt="esp32 devkitv1" width="200">
</div>
<div class="title">Abbildung 2. Espressif ESP32 DevKit v1 Development Board</div>
</div>
<div class="paragraph">
<p>Im Detail stellt der ESP32 einen Access Point mit WPA2 PSK Sicherung zur Verfügung. Das Passwort des Access Points wird hierbei mittels
Hardware RNG in Form einer achtstelligen, positiven Ganzzahl generiert.
Das Passwort und die SSID des Access Points werden auf dem Bildschirm dargestellt (siehe Abschnitt <a href="#sec:oled_screen">[sec:oled_screen]</a>).</p>
</div>
<div class="sect3">
<h4 id="_entwicklung">Entwicklung</h4>
<div class="paragraph">
<p>Der ESP32 ist mit 244 Mhz und zwei CPU Kernen ein potenter 32 Bit Microcontroller. Zudem verfügt der Controller
über eine Vielzahl an Schnittstellen. Neben den oben erwähnten Funktionalitäten verfügt der ESP noch über:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Bluetooth 4.2 (inkl. BLE)</p>
</li>
<li>
<p>18 ADC Kanäle mit 12 bit Auflösung</p>
</li>
<li>
<p>2 DAC mit 8 bit Auflösung</p>
</li>
<li>
<p>10 Touch Sensoren (Kapazitiv)</p>
</li>
<li>
<p>4 SPI Controller</p>
</li>
<li>
<p>2 TWI Controller</p>
</li>
<li>
<p>2 I<sup>2</sup>S Controller</p>
</li>
<li>
<p>3 UART Controller</p>
</li>
<li>
<p>SD/SDIO/MMC/eMMC Host Controller</p>
</li>
<li>
<p>CAN Bus 2.0</p>
</li>
<li>
<p>Motor und LED PWM</p>
</li>
<li>
<p>Hall Effekt Sensor</p>
</li>
<li>
<p>Hardwarebeschleunigte Kryptografie (AES, SHA-2, RSA, ECC, RNG)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Software für den ESP32 kann mit Hilfe der Arduino IDE entwickelt werden. Jedoch ist das SDK des Herstellers, auch als ESP-IDF bezeichnet, vorzuziehen, da
sie der Arduino IDE gegenüber wesentlich mächtiger ist.</p>
</div>
</div>
<div class="sect3">
<h4 id="_esp_idf">ESP-IDF</h4>
<div class="paragraph">
<p>Die Installation der ESP-IDF ist für gängige Betriebssystemen auf der Herstellerseite (siehe <a href="#esp_idf_install">[esp_idf_install]</a>) dokumentiert.
Dem SDK liegt zusätzlich noch eine Ansammlung an Beispielprojekten, sortiert nach Modulen (Wifi, Bluetooth, GPIO, etc), bei.
Diese sind, wie auch die Komponenten der SDK selbst, umfangreich und gut dokumentiert (siehe Header-Dateien).
Beim Aufsetzen eines neuen Projekts empfiehlt es sich, eines der Beispielprojekte zu nehmen (im Zweifelsfall das Hello World), da die ESP-IDF bereits eine auf <em>Make</em> basierende Buildchain anbietet.</p>
</div>
<div class="paragraph">
<p>Diese lässt sich mit folgenden Befehlen bedienen (aus dem Projektverzeichnis heraus):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>make menuconfig &#8594; TUI zur Konfiguration des Projektes (sdkconfig.h)</p>
</li>
<li>
<p>make all &#8594; Bau des Projektes</p>
</li>
<li>
<p>make flash &#8594; ggf. Bau des Projektes und Flashen des ESP</p>
</li>
<li>
<p>make clean &#8594; Bereinigung des Build-Verzeichnisses</p>
</li>
<li>
<p>make monitor &#8594; Starten des pythonbasierten seriellen Monitors</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Um die Buildchain des SDK ohne Einschränkungen verwenden zu können, wird eine Python 2 Installation benötigt. Diese sollte entsprechend unter Verwendung von <em>menuconfig</em> unter <em>SDK Tool Configuration</em> &#8594; <em>Python 2 Interpreter</em> gesetzt werden.</p>
</div>
<div class="paragraph">
<p>Danach muss noch der serielle Port, unter dem der ESP im Betriebssystem angebunden wird, konfiguiert werden. Dies geschieht unter <em>Serial flasher options</em> &#8594; <em>Default serial port</em>.</p>
</div>
<div class="paragraph">
<p>Die ESP-IDF nutzt das Echtzeitbetriebssystem FreeRTOS (siehe <a href="#freertos">[freertos]</a>). Dieses stellt Tasks, Message Queues zur Intertaskkommunikation und Tasksynchronisationsmechanismen (Mutex, etc) zur Verfügung.</p>
</div>
<div class="paragraph">
<p>Als TCP/IP Stack wird LwIP (siehe <a href="#lwip">[lwip]</a>) genutzt. Es handelt sich um eine leichtgewichtige Implementierung, deren Fokus auf Embedded Systems liegt. Angelehnt ist die API an die der POSIX Sockets.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mcu_software">MCU Software</h4>
<div class="paragraph">
<p>Die Struktur des Projektes stellt sich wie folgt dar:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>main_control_unit</p>
<div class="ulist">
<ul>
<li>
<p>components</p>
<div class="ulist">
<ul>
<li>
<p>camera</p>
</li>
<li>
<p>u8g2</p>
</li>
</ul>
</div>
</li>
<li>
<p>main</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Für das Ansprechen der Kamera- (siehe Abschnitt <a href="#sec:camera_module">Kameramodul</a>) und Display-Komponenten (siehe Abschnitt <a href="#sec:oled_display">Bildschirm</a>) wurden
jeweils entsprechende externe Bibliotheken verwendet (näheres in den entsprechenden Abschnitten). Diese sind, wie andere externe Bibliotheken im Allgemeinen, im Ordner <em>components</em> abgelegt.
Der eigentliche Code der Drohne befindet sich im Ordner <em>main</em>. Der Aufbau der eigentlichen Projektdateien ist in Abbildung <a href="#fig:mcu_structure">3</a> gezeigt.</p>
</div>
<div id="fig:mcu_structure" class="imageblock">
<div class="content">
<img src="imgs/mcu_structure.png" alt="mcu structure" width="890" height="196">
</div>
<div class="title">Abbildung 3. MCU Code Struktur</div>
</div>
<div class="paragraph">
<p>Zunächst werden die Komponenten initialisiert. Nach der Initialisierung werden die einzelnen Module (accesspoint.c, etc) gestartet.
Hierbei werden jeweils für die einzelnen Module Tasks generiert, um möglichst parallel zu laufen.</p>
</div>
<div class="sect4">
<h5 id="_main">Main</h5>
<div class="paragraph">
<p>Neben der Initialisierung der einzelnen Software-Module, ist hier auch der <em>Systemeventhandler</em> und die Bildschirmaktualisierung untergebracht.
Der <em>Eventhandler</em> fängt die einzelnen Zustände des Access Points ab (Client verbindet sich, Client trennt sich) und setzt entsprechende Flags in der definierten Systemeventgroup.</p>
</div>
<div class="paragraph">
<p>Exemplarisch ist die Ablaufreihenfolge der Access Point Events in Abbildung <a href="#fig:event_handling_diagram">4</a> gezeigt.</p>
</div>
<div id="fig:event_handling_diagram" class="imageblock">
<div class="content">
<img src="imgs/event_handling_diagram.png" alt="event handling diagram" width="920" height="301">
</div>
<div class="title">Abbildung 4. Ablauf, Start des AP, Client verbindet, Client trennt sich</div>
</div>
<div class="paragraph">
<p>Mit Hilfe der <em>Eventgroup</em> kann nun ein entsprechender Text auf dem Display angezeigt werden, abhängig davon, ob ein Nutzer verbunden ist oder nicht (siehe Abbildung <a href="#fig:display_textupdate">5</a>).</p>
</div>
<div id="fig:display_textupdate" class="imageblock">
<div class="content">
<img src="imgs/display_update_diagram.png" alt="display update diagram" width="637" height="197">
</div>
<div class="title">Abbildung 5. Display Textupdate</div>
</div>
</div>
<div class="sect4">
<h5 id="_access_point_modul">Access Point Modul</h5>
<div class="paragraph">
<p>Das Access Point Modul übernimmt neben der Initialisierung des Wifi auch die Initialisierung des TCP/IP Stacks. Während des Initialisierungsvorgangs wird mit Hilfe des RNG, wie bereits erwähnt, ein acht stelliges numerisches Passwort generiert.
Die Konfiguration des Access Points ist in Tabelle <a href="#table:ap_config">AP Konfiguration</a> aufgeführt.</p>
</div>
<table id="table:ap_config" class="tableblock frame-all grid-all stretch">
<caption class="title">Tabelle 1. AP Konfiguration</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Recon Drone</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kanal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authmode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">WPA_WPA2_PSK</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Versteckt</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">nein</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Max. Verbindungen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Beacon Interval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">192.168.4.1</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_i2c_master_modul">I<sup>2</sup>C Master Modul</h5>
<div class="paragraph">
<p>Zum Einen initialisiert das Modul den Bus als Master und startet den Task zum Senden der Motorsteuerdaten an die jeweiligen ATTinys (siehe Abschnitt <a href="#sec:attiny">Motor Controller</a>).
Die Motorsteuerdaten werden über eine Messagequeue, die vom UDP Socket (siehe Abschnitt <a href="#sec:udp_motor_data">UDP Motor Data Server Module</a>) befüllt wird, geliefert.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Tabelle 2. TWI Bus Konfiguration</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Master</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SDA Leitung</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pin 32</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SCL Leitung</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pin 33</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Taktfrequenz</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100 kHz</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TX Puffer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nein</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RX Puffer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nein</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Zum Anderen wird das Display initialisiert und aus dem <em>Standby</em> aufgeweckt.</p>
</div>
</div>
<div class="sect4">
<h5 id="_camera_modul">Camera Modul</h5>
<div class="paragraph">
<p>Neben der Initialisierung der Kamera mit Hilfe der externen Bibliothek (siehe Abschnitt <a href="#sec:camera_module">Kameramodul</a>), wird im Modul
noch ein Task gestartet, der mittels TCP-Server auf einkommende Verbindungen von Seiten der Steuereinheit wartet.
Nach Verbindungsaufbau sendet der TCP-Server konstant die aus der Kamera ausgelesenen Bilddaten an den Client.
Sobald über die <em>Eventgroup</em> signalisiert wurde, dass der Client die Verbindung unterbrochen hat, wartet der TCP-Server auf einen erneuten Verbindungsaufbau. Dies geschieht zum Einen über die <em>Eventgroup</em> und zum Anderen über das Timeout der Schreiboperation des Sockets.</p>
</div>
<div id="fig:camera_tcp_server" class="imageblock text-center">
<div class="content">
<img src="imgs/camera_tcp_server.png" alt="camera tcp server" width="211" height="462">
</div>
<div class="title">Abbildung 6. Kamera TCP-Server Ablauf</div>
</div>
<table id="table:camera_tcp_config" class="tableblock frame-all grid-all stretch">
<caption class="title">Tabelle 3. Kamera und TCP Socket Konfiguration</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pixel Format</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Grayscale</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Auflösung</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">160 x 120</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP Port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1234</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Die Wahl des Grayscale-Formats und die geringe Auflösung (bei Graustufen jedoch auch 320 x 240 möglich) sind darauf zurückzuführen, dass der ESP32 nicht über
ausreichend internen RAM verfügt, um die Bilddaten vor dem Senden über TCP zwischenzupuffern (siehe Abschnitt <a href="#sec:vision_external_ram">Externer SPI RAM</a>).
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="sec:udp_motor_data">UDP Motor Data Server Module</h5>
<div class="paragraph">
<p>Initialisiert und startet einen UDP Socket, der die Motordaten des Clients empfängt und an eine Messagequeue übergibt.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec:attiny">Motor Controller</h3>
<div class="paragraph">
<p>Um die beiden Motoren anzusteuern, wurde ein ATTiny25 Mikrocontroller pro Motor verwendet.
Über das TWI wird den beiden Mikrocontrollern die gewüschte Richtung und Geschwindigkeit vom
ESP32 mitgeteilt. Sie werden über die Adressen 0x01 und 0x02 angesprochen. Auf Abbildung
<a href="#fig:attiny25_pinout">8</a> sind die Pins für die Takt- (<em>SCL</em>) und Datenleitung (<em>SDA</em>) des TWIs gezeigt.
Der genau Schaltplan, wie die ATTinys mit dem ESP32 verbunden sind, ist im Anhang aufgeführt (siehe Abbildung <a href="#fig:full_schematic">20</a>).
Da die ATTinys nicht über eine Hardwareimplementierung des TWIs verfügen, musste sie in Software realisiert
werden. Hierzu wurde eine bereits existierende Implementation von <a href="#twi_implementation">[twi_implementation]</a> verwendet, welche
die USI Schnittstelle der Mikrocontroller passend für das TWI konfiguriert (siehe <a href="#attiny254585">[attiny254585]</a>).</p>
</div>
<div id="fig:attiny25_pinout" class="imageblock text-center">
<div class="content">
<img src="imgs/attiny25_pinout.jpg" alt="attiny25 pinout" width="300">
</div>
<div class="title">Abbildung 7. ATTiny25 Pinout</div>
</div>
<div class="paragraph">
<p>Die ATTinys erwarten ein Byte, in dem die Richtung und die Geschwindigkeit kodiert sind.
Das höchstwertige Bit kodiert die Richtung. Wird eine <em>0</em> empfangen, wird der Pin <em>DIR0</em> auf <em>HIGH</em>
gesetzt und der Pin <em>DIR1</em> auf <em>LOW</em> gesetzt. Wird eine <em>1</em> empfangen, wird enstprechend Pin <em>DIR0</em>
auf <em>LOW</em> und Pin <em>DIR1</em> auf <em>HIGH</em> gesetzt. Diese beiden Pins sind nie zeitgleich <em>HIGH</em>. Durch die
unteren sieben Bit des empfangenen Bytes wird die Geschwindigkeit in Prozent angegeben. Intern
betreiben die Mikrocontroller hiermit eine Pulsweitenmodulation, welche 127 Schritte unterstützt.
Dieses Signal wird über den Pin <em>PWM</em> ausgegeben. Zwischen den ATTinys und den Motoren wurde eine
H-Brücken eingebaut, um die Motoren mit 11.1V betreiben zu können. Wie die beiden Mikrocontroller
über die H-Brücke mit den beiden Motoren verbunden sind, ist auf Abbildung <a href="#fig:full_schematic">20</a>
im Anhang gezeigt. Der Programmcode für beide Mikrocontroller ist identisch. Die Adresse für das
TWI wird über das Define-Flag <em>address</em> gesetzt werden. Um das Kompilieren des Programms für die
beiden Mikrocontroller zu erleichtern, wurde ein Makefile erstellt. Durch den <em>make</em>
Befehl werden die Programme der beiden Mikrocontroller gebaut. Durch <em>make flash_L</em> und
<em>make flash_R</em> wird entsprechend das Programm für die linke und rechte Motorsteuerung
auf die Mikrocontroller geschrieben. Damit das Kompilieren und Programmieren der ATTinys
funktioniert, müssen die AVR-Entwicklungstools <em>avr-gcc</em>, <em>avr-objcopy</em> und <em>avrdude</em>
installiert sein. Bevor die Programme auf die Mikrocontroller geschrieben werden können,
muss sichergestellt werden, dass der serielle Port des Programmers richtig gesetzt ist. Hierzu
kann das <em>-P</em>-Flag des <em>avrdude</em>-Befehls angepasst werden. Je nachdem, welche Programmer
verwendet wird, muss auch das <em>-c</em>-Flag angepasst werden. In der aktuellen Version wird
davon ausgegangen, dass mit einem AVRISP programmiert wird (siehe <a href="#arduino_programmer">[arduino_programmer]</a>).</p>
</div>
</div>
<div class="sect2">
<h3 id="sec:camera_module">Kameramodul</h3>
<div class="paragraph">
<p>Das verwendete Kameramodul basiert auf dem OV7725 VGA Sensor von Omnivision. Dieses Modul
erfüllt die gängigen Marktansprüche an PC-Multimedia- und Smartphone-Kameras. Es kann in
Temperaturen von -20°C bis 70°C betrieben werden und passt sich automatisch an schlechte
Lichtverhältnisse an. Es unterstützt eine maximale Auflösung von 640x480 Pixel und unterstützt
bis zu 60 FPS. Die Bilddaten können in verschiedenen Formaten über das SCCB Interface erhalten
werden (vgl. <a href="#ov7725">[ov7725]</a>).</p>
</div>
<div id="fig:camera_module" class="imageblock text-center">
<div class="content">
<img src="imgs/camera_module.png" alt="camera module" width="200">
</div>
<div class="title">Abbildung 8. Kameramodul OV7725</div>
</div>
<div class="paragraph">
<p>Zum Ansprechen des Kameramoduls wurde eine bereits existierende Bibliothek verwendet
(vgl. <a href="#esp_cam">[esp_cam]</a>). In der folgenden Tabelle ist beschrieben, wie das Kameramodul mit dem ESP32
verbunden wurde. Es ist anzumerken, dass die Verbindung zwischen dem Kameramodul und dem ESP32
möglichst kurz zu halten ist. Wird die Verbindung zu lang, wird lediglich Rauschen vom ESP32
empfangen.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Tabelle 4. Anschluss der Kamera am ESP32</caption>
<colgroup>
<col style="width: 24%;">
<col style="width: 24%;">
<col style="width: 4%;">
<col style="width: 24%;">
<col style="width: 24%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Kamera Pin</th>
<th class="tableblock halign-left valign-top">ESP32 Pin</th>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top">Kamera Pin</th>
<th class="tableblock halign-left valign-top">ESP32 Pin</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SIOC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO23</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SIOD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO25</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">XCLK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO27</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VSYNC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO22</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HREF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO26</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PCLK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO21</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">D2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO35</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO17</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">D4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO34</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">D6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO39</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO18</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">D8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO36</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO19</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RESET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GPIO15</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PWDN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(über 10kOhm Widerstand auf GND)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.3V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.3V</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GND</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GND</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="sec:oled_display">Bildschirm</h3>
<div class="paragraph">
<p>Verwendung findet ein monochromes OLED-Display mit einer Auflösung von 128x64 Pixel. Dieses basiert auf dem verbreiteten SSD1306 Controller.</p>
</div>
<div id="fig:oled_display" class="imageblock text-center">
<div class="content">
<img src="imgs/oled_display.png" alt="oled display" width="200">
</div>
<div class="title">Abbildung 9. Oled Diplay 128x64, SSD1306</div>
</div>
<div class="paragraph">
<p>Das Display wird hierbei über einen TWI-Bus angebunden. Entsprechend setzt sich der Pinout wie folgt zusammen:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>GND: Ground, Masse</p>
</li>
<li>
<p>VCC: Spannung, 3,3V - 5V</p>
</li>
<li>
<p>SDL: TWI, Datenleitung</p>
</li>
<li>
<p>SCL: TWI, Taktleitung</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Zur Ansteuerung des Displays wird auf die <strong>u8g2</strong> Bibliothek für monochrome LCD- und OLED Bildschirme zurückgegriffen. Diese unterstützt eine Vielzahl an Display Controllern. Die Standardimplementierung ist für die Verwendung unter Arduinos vorgesehen. Jedoch ist die Bibliothek mit hoher Abstraktion aufgebaut und bietet eine Schnittstelle um hardwarespefizische Funktionalitäten anderer Microcontroller wie dem ESP32 zu implementieren.
Für den ESP32 existiert diese Implementierung bereits unter dem Namen <em>u8g2_esp</em> (siehe <a href="#u8g2_esp">[u8g2_esp]</a>). Jedoch wurde die Implementierung so
vorgesehen, dass sie neben dem Ansteuern des Bildschirms auch die Initialisierung des TWI-Controllers übernimmt. Da dies im Projekt bereits geschieht, wurde der entsprechende Teil in der Implementierung entfernt. Auch wurde der verwendete TWI-Controller angepasst. Ursprünglich sah die Implementierung
TWI-Controller 2 vor, die Drohne nutzt jedoch TWI-Controller 1.</p>
</div>
</div>
<div class="sect2">
<h3 id="_stromversorgung">Stromversorgung</h3>
<div class="paragraph">
<p>Im gesamten Projekt werden drei Versorgungsspannungen benötigt: 3.3V für das Kameramodul, 5V für die MCU und die Motorsteuerung, sowie
bis zu 12V für die Motoren. Auf Abbildung <a href="#fig:full_schematic">20</a> im Anhang ist gezeigt, wie die einzelnen Versorgungsspannungen von
der Batterie erhalten werden. Die Motoren werden direkt mit der Batteriespannung betrieben. Um die 5V für die MCU und die Motorsteuerung
zu erhalten, wurde der Spannungsregler 7805 verwendet. Er benötigt mindest 7V als Eingangspannung, um 5V als Ausgungsspannung zu erzeugen.
Um ein Schwanken der Betriebsspannungen zu vermeiden wurden Kondensatoren vor dem Ein- und Ausgang des Spannungsreglers platziert. Die für
das Kameramodul benötigten 3.3V werden vom ESP32 erzeugt. Bei der Realisierung dieses Projektes fiel die Entscheidung auf einen 3-Zellen LiPo-Akku,
wodurch 11.1V als Batteriespannung anliegen.</p>
</div>
</div>
<div class="sect2">
<h3 id="_schaltplan_und_pcb">Schaltplan und PCB</h3>
<div class="paragraph">
<p>Zu Beginn des Projekts wurden die einzelnen Komponenten auf einem Breadboard verkabelt, getestet und anschließend auf einer
Lochrasterplatine in einem Prototypen verlötet. Dieser Prototyp ist auf Abbildung <a href="#fig:prototyp">11</a> zu sehen.</p>
</div>
<div id="fig:prototyp" class="imageblock text-center">
<div class="content">
<img src="imgs/lochrasterplatine.png" alt="lochrasterplatine" width="500">
</div>
<div class="title">Abbildung 10. Lochrasterplatine</div>
</div>
<div class="paragraph">
<p>Nachdem die Funktionalität des Aufbaus der Hardware verifiziert wurde, wurde ein PCB mit der Eagle Software von Autodesk designed
(siehe <a href="#eagle">[eagle]</a>). Die Eagle-Projektdateien sind im Ordner <em>schematic_and_pcb</em> zu finden. Anschließend wurde JLCPCB (siehe <a href="#jlcpcb">[jlcpcb]</a>)
mit der Fertigung des PCBs beauftragt. Das fertig bestückte PCB ist auf Abbildung <a href="#fig:pcb">12</a> gezeigt.</p>
</div>
<div id="fig:pcb" class="imageblock text-center">
<div class="content">
<img src="imgs/pcb.png" alt="pcb" width="500">
</div>
<div class="title">Abbildung 11. Fertige bestücktes PCB</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_entwicklung_einer_steuerung">Entwicklung einer Steuerung</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Aufgrund der schlichten Schnittstelle zur Drohne ist es sehr einfach, eine
beliebige Steuerung zu implementieren. Um die Drohne anzusteuern, muss sich
zuerst mit dem bereitgestellten W-Lan-Netzwerk verbunden werden. Innerhalb
dieses Netzwerkes hat die Drohne immer die IP-Addresse <em>192.168.4.1</em>. Um
das Kamerasignal zu erhalten, muss eine TCP-Verbindung zur Drohne über
Port <em>1234</em> aufgebaut werden. Die Drohne sendet das Bildsignal Byteweise
an den Client. Das übersendete Bild ist im Grayscale-Format und besitzt eine
Auflösung von 160x120 Pixeln. Um die Drohne zu steuern, müssen ihr zwei
Bytes per UDP über Port 4242 übertragen werden. Das erste Byte steuert den linken Motor
und das zweite Byte steuert den rechten Motor (vgl. Abbildung <a href="#fig:udp-packet">1</a>).</p>
</div>
<div id="fig:udp-packet" class="imageblock text-center">
<div class="content">
<img src="imgs/udp-packet.png" alt="udp packet" width="490" height="126">
</div>
<div class="title">Abbildung 12. UDP-Paketformat</div>
</div>
<div class="paragraph">
<p>Das <em>Direction</em> bit gibt an, ob die Motoren vorwärts (0) oder rückwärst (1) drehen.
In den sieben <em>Speed</em> bits wird die prozentuale Geschwindigkeit definiert, also ein
Wert im Intervall [0, 100]. Um die Drohne um Hindernisse zu manövrieren, muss die
Geschwindigkeit der beiden Motoren unterschiedlich hoch definiert werden.</p>
</div>
<div class="paragraph">
<p>Im Folgenden wird eine Referenzimplementierung der Drohnensteuerung am Beispiel
einer Android App beschrieben.</p>
</div>
<div class="sect2">
<h3 id="_referenzimplementierung_für_android">Referenzimplementierung für Android</h3>
<div class="paragraph">
<p>Zur Steuerung der Recon Drone wurde eine simple Android App entwickelt.
Sie besteht im Grunde aus zwei Ansichten, eine zum Verbinden mit der Drohne
und eine zum Steuern der Drohne. Beide Ansichten sind auf Abbildung <a href="#fig:app">13</a>
gezeigt. Die App sucht nach dem W-Lan-Netzwerk, das von der Drohne bereitgestellt
wird. Damit W-Lan-Netzwerke gesucht werden können, muss der Standort-Service des
Smartphones aktiviert sein. Wurde das Netzwerk gefunden, wird das Passwort zum
Verbinden verlangt. Wurde das Passwort eingegeben und der "Verbinden"-Button
gedrückt, baut die App die Verbindung zur Drohne auf. Damit die App mit der Drohne
kommunizieren kann, muss das mobile Internet deaktiviert sein. Diese Funktionalität
wird durch die <em>ReconDroneConnection</em>-Klasse realisiert (vgl. Abbildung <a href="#fig:classdiagram">14</a>).
Hat sich das Smartphone mit der Drohne verbunden, wird automatisch zur nächsten Ansicht der
App gewechselt, welche durch die <em>ReconDrone</em>-Klasse realisiert wird.</p>
</div>
<div id="fig:app" class="imageblock text-center">
<div class="content">
<img src="imgs/app.png" alt="app" width="500">
</div>
<div class="title">Abbildung 13. Ansichten der App</div>
</div>
<div class="paragraph">
<p>Aus dieser zweiten Ansicht kann die Drohne gesteuert werden und das Kamerasignal
eingesehen werden. Die Steuerung wird von der <em>TouchController</em>-Klasse implementiert.
Die Touchevents des Benutzer werden in der <em>onTouch()</em>-Methode verarbeitet. In ihr
werden die Startpositionen und die aktuellen Positionen der Touchbewegungen verarbeitet und
in den Attributen <em>startingPositions</em> und <em>currentPositions</em> zwischengespeichert.
Die komplette rechte Hälfte des Bildschirms dient zur Beschleunigung
der Drohne. Je weiter der Finger vom Startpunkt der Touchbewegung entfernt ist, desto
schneller bewegt sich die Drohne. Die linke Hälfte des Bildschirms dient zur Lenkung
der Drohne. In den Attributen <em>accerleration</em> und <em>steering</em> wird die ID des jeweiligen
Touchevents gespeichert. Wenn kein Touchevent vorliegt, enthalten die beiden Attribute
den Wert -1. Alle 50 Millisekunden wird die Methode <em>sendControllerUpdate()</em> aufgerufen,
welche der Drohne die Steuersignale sendet. Es werden zwei Bytes übertragen, die jeweils
die Geschwindigkeit und Richtung für einen Motor definieren. Die beiden Bytes werden in
den Methoden <em>setAcceleration()</em>, <em>setSteering()</em>, <em>setDirection()</em> und <em>adjustForInPlaceTurn()</em>
befüllt.</p>
</div>
<div id="fig:classdiagram" class="imageblock text-center">
<div class="content">
<img src="imgs/diagram-classes.png" alt="diagram classes" width="642" height="728">
</div>
<div class="title">Abbildung 14. Klassendiagramm</div>
</div>
<div class="paragraph">
<p>Das Kamerasignal der Drohne wird in der <em>CameraFeed</em>-Klasse verarbeitet. Sie nimmt in
ihrem Konstruktor das <em>ImageView</em>-Objekt entgegen, in dem sie das Kamerasignal anzeigen
soll. Sie startet einen Hintergrundthread, in dem die einzelnen Bilder empfangen werden
und wandelt die Byte-Daten in ein Bitmap um. Da in Android das User-Interface nicht aus
einem Hintergrundthread angepasst werden kann, wird ein <em>Handler</em> verwendet, der das
Bitmap im <em>ImageView</em> anzeigt.</p>
</div>
<div class="paragraph">
<p>Um die Android App zu installieren, muss die APK-Datei auf das Smartphone übertragen werden.
Sie befindet sich im Ordner <em>android_app/app/build/outputs/apk/debug</em>. Um sie zu installieren
muss in den Einstellungen des Smartphones die Installation von Apps aus unsicheren Quellen
erlaubt werden. Auf dem Smartphone muss mindestens Android 5.0 installiert sein. Die App wurde
unter Android 9.0 getestet.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ausblick">Ausblick</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Auf Basis des derzeitigen Entwicklungsstands der Drohne lassen sich weitere Zusatzfunktionen und Verbesserungen implementieren. Einige
Ideen sollen im Folgenden präsentiert werden.</p>
</div>
<div class="sect2">
<h3 id="_gehäuse">Gehäuse</h3>
<div class="paragraph">
<p>Derzeit ist das Chassis der Drohne noch im Prototypenzustand, gefertigt aus Stahllochblechprofilen. Diese Bauart ist zum Einen relativ schwer und bietet keinen Rundumschutz.
Es bietet sich deshalb an, ein Gehäuse mittels 3D-Druck anzufertigen. Während des Projektes wurde bereits eine erste Version des Gehäuses mittels CAD Software (siehe <a href="#openscad">[openscad]</a>)  modeliert. Dieses kann evaluiert und gedruckt werden oder durch ein anderes, völlig neues Design ersetzt werden.</p>
</div>
</div>
<div class="sect2">
<h3 id="_verpolschutz">Verpolschutz</h3>
<div class="paragraph">
<p>Im aktuellen Stand wird der LiPo-Akku mittels <em>Male Headern</em> am PCB der Drohne angeschlossen. Der Akku verfügt über eine Buchse vom Typ <em>JST RCY</em>. Zum Einen könnte ein entsprechender <em>Female</em> Verbinder für THT Platinen verbaut werden, um eine richtige Polung beim Anschließen zu garantieren.
Zum Anderen kann mit Hilfe eines Brückengleichrichters (siehe Abbildung <a href="#fig:bridge_rectifier">15</a>) hinter dem Akkuanschluss ein Schutz vor Verpolung garantiert werden.</p>
</div>
<div id="fig:bridge_rectifier" class="imageblock text-center">
<div class="content">
<img src="imgs/bridge_rectifier.png" alt="bridge rectifier" width="200">
</div>
<div class="title">Abbildung 15. Diodenbrückengleichrichter</div>
</div>
<div class="paragraph">
<p>Die Funktionsweise der Brücke ist relativ simple. Unabhängig davon, wie der Strom angelegt wird, schließt die Konfiguration der Dioden stets so, dass am Ausgang der Brücke Plus und Minus immer gleich anliegen.
Eine Diode hat entsprechend die Eigenschaft, Strom in eine Richtung hin passieren zu lassen, während sie in entgegengesetzter Richtung den Stromfluss sperrt.</p>
</div>
</div>
<div class="sect2">
<h3 id="_raspberry_pi_zero_w">Raspberry PI zero W</h3>
<div class="paragraph">
<p>Alternativ kann als MCU der Raspberry PI zero W evaluiert werden. Vorteil dieses Einplatinencomputers im Gegensatz zum ESP32 ist der wesentlich größere RAM, der das Puffern größerer Kamerabilddaten ermöglicht (siehe Abschnitt <a href="#sec::camera_module">[sec::camera_module]</a>).</p>
</div>
</div>
<div class="sect2">
<h3 id="_alternative_stromversorgung">Alternative Stromversorgung</h3>
<div class="paragraph">
<p>Aktuell wird ein linearer Spannungsregler verwendet, um die hohe Batteriespannung von 11.1V auf die 5V
zu reduzieren, die von der MCU und den ATTinys benötigt werden. Hierbei wird sehr viel Energie
in Form von Wärme verschwendet. Dies beeinflusst die Batterielaufzeit der Drohne negativ. Weiterhin
besteht die Möglichkeit, dass der Spannungsregler überhitzt, in welchem Fall er sich abschalten
würde. Erst wenn er weit genug abgekühlt ist, gibt er wieder 5V aus. Dies würde zum Abschalten der
Drohne führen. Alternativ könnte ein <em>Step-Down-Converter</em> oder auch <em>Buck-Converter</em> verwendet werden.
Im Vergleich zu einem linearen Spannungsregler wird verschwendet diese Variante weniger Energie und erhöht
somit die Batterielaufzeit der Drohne. Allerdings wird die Schaltung etwas komplexer und die benötigten
Komponenten kosten etwas mehr als ein linearer Spannungsregler.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec:vision_external_ram">Externer SPI RAM</h3>
<div class="paragraph">
<p>Das Kamerabild, das von der Drohne übertragen wird, kann aktuell eine maximale Auflösung von 320x240 Pixeln
unterstützen, wenn es im Grayscale-Format übertragen wird. Diese Einschränkungen sind auf den begrenzten
internen RAM des ESP32 zurückzuführen. Er besitzt eine Größe von 320KB, welche sich in zwei Teile
unterteilt. Aufgrund von technischen Einschränkungen können maximal 160KB statisch allokiert werden. Die restlichen
160KB können nur während der Laufzeit dynamisch allokiert werden (vgl. <a href="#esp32_kevin">[esp32_kevin]</a>). Bei einer Auflösung von 320x240 Pixeln und einem
Byte für den Grauwert eines Pixels benötigt ein Bild bereits 76.8KB, um es vor dem Senden zwischenzuspeichern.
Ein farbiges Bild ist nicht möglich, da dies Aufgrund der 3 Bytes pro Pixel, eines pro Farbkanal, bei einer Größe von
230.4KB liegen würde. Wird versucht ein Byte-Array dieser Größe zu allokieren, gibt der ESP32 eine Fehlermeldung aus.
Es ist jedoch möglich, den internen RAM des ESP32 um einen externen RAM zu erweiteren, der über das SPI-Interface
angeschlossen wird. Ist der gewählte externe RAM groß genug, kann ein farbiges Bild in der maximalen Auflösung
des Sensors von 640x480 Pixeln aufgenommen werden. Hierfür werden 921,6KB benötigt.</p>
</div>
</div>
<div class="sect2">
<h3 id="_drehzahlkorrektur_der_motordrehzahl">Drehzahlkorrektur der Motordrehzahl</h3>
<div class="paragraph">
<p>Da die Motoren bedingt durch geringfügige Fertigungsunterschiede (unterschiede in der Erregerwicklung, etc) laufen die Motoren bei gleichem PWM Signal nicht identisch schnell. Entsprechend hat die Drohne die Tendenz bei Geradeausfahrten in eine bestimmte Richtung zu fahren.
Um diesem Verhalten entgegenzuwirken, muss der ESP32 anhand der tatsächlichen Drehzahl der Motoren Korrekturwerte an die Motorcontroller übergeben. Um die Drehzahl bei einem Gleichstrommotor zu ermitteln, können beispielsweise folgende Verfahren angewandt werden:</p>
</div>
<div class="paragraph">
<p><strong>Back EMF - Back Electromotive Force</strong>: Da ein PWM Signal den Motor nicht durchgehend mit Spannung versorgt, sondern nur in Intervalen, befindet sich der Motor auch immer in Phasen, in denen er keine Spannungsversorgung erhält. Bedingt durch die Trägheit dreht der Motor sich noch eine gewisse Zeit weiter. In dieser Phase generiert der Motor eine Spannung durch elektrische Induktion (siehe Induktionsgesetze von Michael Faraday, Joseph Henry und Hans Christian Ørsted und Lenzsche Regel nach Emil Lenz), dem Back EMF. Diese Spannung kann entsprechend von einem ADC eingelesen und interpretiert werden. Es ist zu beachten, dass die Spannung ggf. erst mittels Spannungsteiler auf ein für den Microcontroller sicher messbaren Spannungsbereich herunter bricht (max. 5V).</p>
</div>
<div class="paragraph">
<p><strong>Rotary Encoder</strong>: Beim Rotary Encoder bzw. Drehgeber handelt es sich im einfachsten Fall um eine Scheibe mit Schlitzen in gleichen Abständen zueinander, wie in Abbildung <a href="#fig:rotary_wheel">16</a> gezeigt. Diese Scheibe ist an der Welle des Motors angebracht.</p>
</div>
<div id="fig:rotary_wheel" class="imageblock text-center">
<div class="content">
<img src="imgs/rotary_encoder.png" alt="rotary encoder" width="200">
</div>
<div class="title">Abbildung 16. Drehgeber, Scheibe, <a href="#rotary_encoder_img">[rotary_encoder_img]</a></div>
</div>
<div class="paragraph">
<p>Die Schreibe dreht sich hierbei zwischen einer Lichtschranke, wie in Abbildung <a href="#fig:light_barrier">17</a>, die wiederum aufgrund der Schlitze in der Scheibe abwechselnt eine Spannung ausgibt oder nicht. Ausgelesen mit einem GPIO-Pin ergibt sich hieraus ein Signal in Sägezahnform, wobei die Frequenz der Flankenwechsel der Umdrehung des Motors entspricht.</p>
</div>
<div id="fig:light_barrier" class="imageblock text-center">
<div class="content">
<img src="imgs/light_barrier.png" alt="light barrier" width="200">
</div>
<div class="title">Abbildung 17. Drehgeber, Lichtschranke, <a href="#light_barrier_img">[light_barrier_img]</a></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_glossar">Glossar</h2>
<div class="sectionbody">
<div class="dlist glossary">
<dl>
<dt>TWI</dt>
<dd>
<p>Two Wire Interface (bekannt als I<sup>2</sup>C), zweiadriger Master-Slave Bus</p>
</dd>
<dt>MCU</dt>
<dd>
<p>Main Control Unit</p>
</dd>
<dt>PCB</dt>
<dd>
<p>Printed Ciruit Board</p>
</dd>
<dt>USI</dt>
<dd>
<p>Universial Serial Interface</p>
</dd>
<dt>BLE</dt>
<dd>
<p>Bluetooth Low Energy</p>
</dd>
<dt>ADC</dt>
<dd>
<p>Analog Digital Converter</p>
</dd>
<dt>DAC</dt>
<dd>
<p>Digital Analog Converter</p>
</dd>
<dt>PWM</dt>
<dd>
<p>Pulse Width Modulation</p>
</dd>
<dt>AP</dt>
<dd>
<p>Access Point</p>
</dd>
<dt>RNG</dt>
<dd>
<p>Random Number Generator</p>
</dd>
<dt>SDK</dt>
<dd>
<p>Software Development Kit</p>
</dd>
<dt>THT</dt>
<dd>
<p>Through Hole Technology, Durchsteckmontage</p>
</dd>
<dt>FPS</dt>
<dd>
<p>Frames per Second</p>
</dd>
<dt>SCCB</dt>
<dd>
<p>Serial Camera Control Bus</p>
</dd>
<dt>SPI</dt>
<dd>
<p>Serial Peripheral Interface</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_quellen">Quellen</h2>
<div class="sectionbody">
<div class="ulist bibliography">
<ul class="bibliography">
<li>
<p><a id="u8g2"></a>[u8g2] Graustufenbildschirm Bibliothek: <a href="https://github.com/olikraus/u8g2" class="bare">https://github.com/olikraus/u8g2</a></p>
</li>
<li>
<p><a id="u8g2_esp"></a>[u8g2_esp] esp idf wrapper: <a href="https://github.com/nkolban/esp32-snippets/tree/master/hardware/displays/U8G2" class="bare">https://github.com/nkolban/esp32-snippets/tree/master/hardware/displays/U8G2</a></p>
</li>
<li>
<p><a id="esp_cam"></a>[esp_cam] esp idf Kamera Bibliothek: <a href="https://github.com/igrr/esp32-cam-demo.git" class="bare">https://github.com/igrr/esp32-cam-demo.git</a></p>
</li>
<li>
<p><a id="arduino_programmer"></a>[arduino_programmer] Arduino Uno als Programmer: <a href="https://create.arduino.cc/projecthub/arjun/programming-attiny85-with-arduino-uno-afb829" class="bare">https://create.arduino.cc/projecthub/arjun/programming-attiny85-with-arduino-uno-afb829</a></p>
</li>
<li>
<p><a id="eagle"></a>[eagle] Eagle Software: <a href="https://www.autodesk.co.uk/products/eagle/overview" class="bare">https://www.autodesk.co.uk/products/eagle/overview</a></p>
</li>
<li>
<p><a id="twi_implementation"></a>[twi_implementation] TWI Implementation: <a href="https://github.com/rambo/TinyWire" class="bare">https://github.com/rambo/TinyWire</a></p>
</li>
<li>
<p><a id="attiny254585"></a>[attiny254585] ATTiny25/45/85 Datenblatt: <a href="https://ww1.microchip.com/downloads/en/DeviceDoc/Atmel-2586-AVR-8-bit-Microcontroller-ATtiny25-ATtiny45-ATtiny85_Datasheet.pdf" class="bare">https://ww1.microchip.com/downloads/en/DeviceDoc/Atmel-2586-AVR-8-bit-Microcontroller-ATtiny25-ATtiny45-ATtiny85_Datasheet.pdf</a></p>
</li>
<li>
<p><a id="esp_idf_install"></a>[esp_idf_install] ESP-IDF Getting Started: <a href="https://docs.espressif.com/projects/esp-idf/en/latest/get-started/index.html" class="bare">https://docs.espressif.com/projects/esp-idf/en/latest/get-started/index.html</a></p>
</li>
<li>
<p><a id="freertos"></a>[freertos] FreeRTOS, Dokumentation: <a href="https://www.freertos.org/Documentation/RTOS_book.html" class="bare">https://www.freertos.org/Documentation/RTOS_book.html</a></p>
</li>
<li>
<p><a id="lwip"></a>[lwip] LwIP TCP/IP Stack: <a href="https://savannah.nongnu.org/projects/lwip/" class="bare">https://savannah.nongnu.org/projects/lwip/</a></p>
</li>
<li>
<p><a id="openscad"></a>[openscad] OpenSCAD: <a href="http://www.openscad.org/" class="bare">http://www.openscad.org/</a></p>
</li>
<li>
<p><a id="ov7725"></a>[ov7725] OV7725 Sensor: <a href="https://www.ovt.com/sensors/OV7725" class="bare">https://www.ovt.com/sensors/OV7725</a></p>
</li>
<li>
<p><a id="esp32_kevin"></a>[esp32_kevin] Projekterfahrung EspressifESP32 –Fallbeispiel "Kevin", arendi, Benno Trutmann: <a href="https://www.swisst.net/fileadmin/swissTmeetings/ECC2018/Referate/2B1_Trutmann_Arendi.pdf" class="bare">https://www.swisst.net/fileadmin/swissTmeetings/ECC2018/Referate/2B1_Trutmann_Arendi.pdf</a></p>
</li>
<li>
<p><a id="light_barrier_img"></a>[light_barrier_img] Bild, Lichtschranke, rs-online: <a href="https://de.rs-online.com/web/p/products/1254555/?grossPrice=Y&amp;cm_mmc=DE-PLA-DS3A-" class="bare">https://de.rs-online.com/web/p/products/1254555/?grossPrice=Y&amp;cm_mmc=DE-PLA-DS3A-</a><em>-google-</em>-PLA_DE_DE_Automation-<em>-Sensoren_Und_Messwandler%7COptische_N%C3%A4herungsschalter-</em>-PRODUCT_GROUP&amp;matchtype=&amp;pla-484761195991&amp;gclid=EAIaIQobChMIuM6t2bXP4AIVQqmaCh0CqgscEAQYByABEgJ_FfD_BwE&amp;gclsrc=aw.ds</p>
</li>
<li>
<p><a id="rotary_encoder_img"></a>[rotary_encoder_img] Encoder Scheibe, eckstein-shop: <a href="https://eckstein-shop.de/Adafruit-TT-Motor-Getrieb-DC-Motor-Encoder-Pack-of-2?curr=EUR&amp;gclid=EAIaIQobChMI_NL52LjP4AIVDOh3Ch3fzAbyEAQYCyABEgId1vD_BwE" class="bare">https://eckstein-shop.de/Adafruit-TT-Motor-Getrieb-DC-Motor-Encoder-Pack-of-2?curr=EUR&amp;gclid=EAIaIQobChMI_NL52LjP4AIVDOh3Ch3fzAbyEAQYCyABEgId1vD_BwE</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_anhang">Anhang</h2>
<div class="sectionbody">
<div id="fig:pcb_front" class="imageblock text-center">
<div class="content">
<img src="imgs/pcb_front.png" alt="pcb front">
</div>
<div class="title">Abbildung 18. PCB Oberseite</div>
</div>
<div id="fig:pcb_back" class="imageblock text-center">
<div class="content">
<img src="imgs/pcb_back.png" alt="pcb back">
</div>
<div class="title">Abbildung 19. PCB Unterseite</div>
</div>
<div id="fig:full_schematic" class="imageblock text-center">
<div class="content">
<img src="imgs/full_schematic.png" alt="full schematic">
</div>
<div class="title">Abbildung 20. Kompletter Schaltplan</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2019-02-22 11:07:46 +0100
</div>
</div>
</body>
</html>